--- 
layout: post
title: 贝叶斯个性化排序
tags: 
- 算法
- 推荐系统
status: publish
type: post
published: false
---

本篇主要关注于 Bayesian Personalized Ranking-Matrix Factorization，BPR 是基于隐式反馈数据的非常通用的个性化模型。

她的优势有以下几点：

- 不关注于拟合的具体数值损失最小，而是关注于item的排序关系
- 因为是潜变量模型，预测只是向量的相乘，工程化性能优异

我们先考虑一下原始的数据以及优化的方向。

![](/upload/pic/BPR_ij.png)

左边表示的原始的观测矩阵，右边是对于每个 user 的 pairwise 偏好：+表示用户喜欢 i 多于 j，-表示用户喜欢 i 少于 j。

- 对于概率问题，我们很容易想到使用 sigmod 函数来进行拟合。
- 到底是大于0还是小于0，那最直接就是通过__减__的方式

假如对于第k个用户，他的用户向量表示为 $$u_k$$，商品(i和j)向量表示为 $$s_i$$ 和 $$s_j$$。

我们希望 $$\frac{1}{1 + e^(u_k * s_i)^{-1}}$$ 表示用户k对商品i的偏好。